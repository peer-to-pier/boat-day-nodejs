/*! boatday 2016-04-11 */
var $page=function(a){return $('[page="'+a+'"]')},fbAsyncInit=function(){console.todo("check if it prints well"),FB.init({appId:"#{process.env.FB_APP_ID}",xfbml:!0,version:"v2.5"})},AuthFBLogin=function(){console.todo("catch facebook errors"),console.todo("Refine Scope"),FB.login(function(a){if(a.authResponse){var b=$("<form/>",{method:"post",action:"/users/facebook"});$.each(a.authResponse,function(a,c){b.append($("<input/>",{type:"hidden",name:a,value:c}))}),b.submit()}},{scope:"public_profile,email,user_about_me,user_birthday,user_friends"})};console.todo=function(a){console.debug("> ToDo: "+a)},function(a){a.fn.scrollTo=function(){a("html, body").animate({scrollTop:this.offset().top-a("#mainNavbar").height()},"slow")},a.fn.field=function(b){var c="";return a.each(b.split(","),function(a,b){c+=(""!==c?c+=", ":"")+'[name="'+b.trim()+'"]'}),this.find(c)},a.fn.ajaxerize=function(b,c,d){if(b.preventDefault(),b.stopPropagation(),!this.attr("action"))return console.error('Attribute "action" missing in <form>.'),!1;this.find(".has-danger").removeClass("has-danger"),this.find(".form-control-danger").removeClass("form-control-danger").popover("dispose");var e=!1,f={};return this.find("input, textarea").each(function(b,c){var d=a(c);d.attr("required")&&""===d.val()&&(e=!0,d.customError("Ooops, you missed one.")),f[d.attr("name")]=d.val()}),e?!1:(this.find('[type="submit"]').attr("disabled",!0),a.ajax({data:f,type:this.attr("method")?this.attr("method"):"GET",url:this.attr("action"),context:this}).done(function(a,b,c){this.find('[type="submit"]').removeAttr("disabled"),this.trigger("ajax-done",a.responseJSON)}).fail(function(a,b,c){this.find('[type="submit"]').removeAttr("disabled"),this.trigger("ajax-fail",a.responseJSON)}),this)},a.fn.customError=function(a){return a&&this.popover({container:"body",placement:"top",content:a,trigger:"hover",title:""}),this.addClass("form-control-danger").closest(".form-group").addClass("has-danger"),this},a.fn.cleanError=function(a){return this.popover("dispose").removeClass("form-control-danger").closest(".form-group").removeClass("has-danger"),this}}(jQuery),window.fbAsyncInit=fbAsyncInit,function(a,b,c){var d,e=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//connect.facebook.net/en_US/sdk.js",e.parentNode.insertBefore(d,e))}(document,"script","facebook-jssdk"),$(function(){$page("guest").on("ajax-fail",".login",function(a,b){console.log($(this).field("email,pass")),b.code&&101===b.code&&$(this).field("email,pass").customError(b.message)}).on("ajax-fail",".signup",function(a,b){console.log("success fail",b)}).on("click",".fb-login",AuthFBLogin),$(document).on("submit","form",function(a){$(this).ajaxerize(a)}).on("click","a",function(){"#"===$(this).attr("href").substr(0,1)&&$($(this).attr("href")).scrollTo()})});